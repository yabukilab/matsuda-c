<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ”ã‚¢ãƒãƒ¬ãƒƒã‚¹ãƒ³äºˆç´„ã‚·ã‚¹ãƒ†ãƒ </title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #ffeef8 0%, #f0e6ff 100%);
            min-height: 100vh;
            color: #5a4b7c;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            color: #8b5fb5;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(139, 95, 181, 0.2);
        }

        .card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(139, 95, 181, 0.2);
            margin-bottom: 20px;
            border: 3px solid #e8d5f2;
        }

        .login-form {
            max-width: 400px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #8b5fb5;
        }

        input[type="text"], input[type="password"], input[type="date"], select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e8d5f2;
            border-radius: 10px;
            font-size: 16px;
            background: #ffffff;
            transition: all 0.3s ease;
        }

        input[type="text"]:focus, input[type="password"]:focus, input[type="date"]:focus, select:focus {
            outline: none;
            border-color: #8b5fb5;
            box-shadow: 0 0 10px rgba(139, 95, 181, 0.3);
        }

        .btn {
            background: linear-gradient(45deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
            box-shadow: 0 5px 15px rgba(255, 154, 158, 0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 154, 158, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #a8e6cf 0%, #dcedc1 100%);
            color: #5a4b7c;
        }

        .btn-danger {
            background: linear-gradient(45deg, #ffb3ba 0%, #ffdfba 100%);
        }

        .calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .calendar-nav {
            background: #8b5fb5;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 18px;
        }

        .calendar-nav:hover {
            background: #7a4fa3;
        }

        .calendar-month {
            font-size: 1.5em;
            font-weight: bold;
            color: #8b5fb5;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            border: 2px solid transparent;
            position: relative;
        }

        .calendar-day.weekday-name {
            background: #8b5fb5;
            color: white;
            cursor: default;
            font-size: 0.9em;
        }

        .calendar-day.available {
            background: #d4f8d4;
            color: #2d5a2d;
            border-color: #a8e6cf;
        }

        .calendar-day.available:hover {
            background: #a8e6cf;
            transform: scale(1.1);
        }

        .calendar-day.fully-booked {
            background: #ffb3ba;
            color: #8b4545;
            cursor: not-allowed;
            border-color: #ff9a9e;
        }

        .calendar-day.fully-booked::after {
            content: 'æº€';
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 0.7em;
            background: #ff6b6b;
            color: white;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .calendar-day.selected {
            background: #ff9a9e;
            color: white;
            border-color: #8b5fb5;
            transform: scale(1.1);
        }

        .calendar-day.other-month {
            color: #ccc;
            cursor: default;
        }

        .time-slots {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }

        .time-slot {
            padding: 10px;
            background: #d4f8d4;
            border: 2px solid #a8e6cf;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .time-slot:hover {
            background: #a8e6cf;
            transform: translateY(-2px);
        }

        .time-slot.selected {
            background: #ff9a9e;
            color: white;
            border-color: #8b5fb5;
        }

        .time-slot.booked {
            background: #ffb3ba;
            color: #7a4fa3;
            cursor: not-allowed;
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        .error-message {
            background: #ffb3ba;
            color: #8b5fb5;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 2px solid #ff9a9e;
        }

        .success-message {
            background: #d4f8d4;
            color: #2d5a2d;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 2px solid #a8e6cf;
        }

        .lesson-info {
            background: #f8f4ff;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 2px solid #e8d5f2;
        }

        .teacher-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .teacher-card {
            background: #ffffff;
            padding: 15px;
            border-radius: 15px;
            border: 2px solid #e8d5f2;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .teacher-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(139, 95, 181, 0.2);
        }

        .teacher-card.selected {
            border-color: #8b5fb5;
            background: #f8f4ff;
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(139, 95, 181, 0.3);
        }

        .teacher-card.selected.beginner {
            background: linear-gradient(135deg, #d4f8d4 0%, #a8e6cf 100%);
            border-color: #4caf50;
            color: #2d5a2d;
        }

        .teacher-card.selected.intermediate {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            border-color: #ff9800;
            color: #8b6914;
        }

        .teacher-card.selected.advanced {
            background: linear-gradient(135deg, #ffb3ba 0%, #ff9a9e 100%);
            border-color: #e91e63;
            color: #8b4545;
        }

        .piano-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .selected-teacher-info {
            background: #f0f8ff;
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 15px;
            border: 2px solid #8b5fb5;
            text-align: center;
            font-weight: bold;
            color: #8b5fb5;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¹ ãƒ”ã‚¢ãƒãƒ¬ãƒƒã‚¹ãƒ³äºˆç´„ã‚·ã‚¹ãƒ†ãƒ </h1>
        </div>

        <!-- ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ -->
        <div id="loginScreen" class="screen active">
            <div class="card">
                <div class="login-form">
                    <h2 style="text-align: center; margin-bottom: 30px; color: #8b5fb5;">ãƒ­ã‚°ã‚¤ãƒ³</h2>
                    <div class="form-group">
                        <label for="studentId">å—è¬›è€…ç•ªå·ï¼ˆ7æ¡ï¼‰</label>
                        <input type="text" id="studentId" maxlength="7" placeholder="1234567">
                    </div>
                    <div class="form-group">
                        <label for="password">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</label>
                        <input type="password" id="password" maxlength="36" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›">
                    </div>
                    <div style="text-align: center;">
                        <button class="btn" onclick="login()">ãƒ­ã‚°ã‚¤ãƒ³</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ãƒ­ã‚°ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼ç”»é¢ -->
        <div id="loginErrorScreen" class="screen">
            <div class="card">
                <div class="error-message">
                    <h3 style="text-align: center;">ãƒ­ã‚°ã‚¤ãƒ³ã‚¨ãƒ©ãƒ¼</h3>
                    <p style="text-align: center; margin-top: 10px;">ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸã€‚<br>æ­£ã—ã„å—è¬›è€…ç•ªå·ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥ã‚Œã¦ãã ã•ã„</p>
                </div>
                <div style="text-align: center;">
                    <button class="btn btn-secondary" onclick="showScreen('loginScreen')">TOPã¸æˆ»ã‚‹</button>
                </div>
            </div>
        </div>

        <!-- äºˆç´„ç”»é¢ -->
        <div id="reservationScreen" class="screen">
            <div class="card">
                <h2 style="text-align: center; margin-bottom: 30px; color: #8b5fb5;">ğŸ¹ ãƒ”ã‚¢ãƒãƒ¬ãƒƒã‚¹ãƒ³äºˆç´„</h2>
                
                <div class="lesson-info">
                    <h3>ãƒ¬ãƒƒã‚¹ãƒ³é¸æŠ</h3>
                    <div class="teacher-list">
                        <div class="teacher-card" onclick="selectTeacher('ç”°ä¸­å…ˆç”Ÿ', 'beginner')">
                            <div class="piano-icon">ğŸŒ±</div>
                            <div>ç”°ä¸­å…ˆç”Ÿ</div>
                            <div style="font-size: 0.9em; color: #8b5fb5;">åˆç´š</div>
                        </div>
                        <div class="teacher-card" onclick="selectTeacher('ä½è—¤å…ˆç”Ÿ', 'intermediate')">
                            <div class="piano-icon">ğŸµ</div>
                            <div>ä½è—¤å…ˆç”Ÿ</div>
                            <div style="font-size: 0.9em; color: #8b5fb5;">ä¸­ç´š</div>
                        </div>
                        <div class="teacher-card" onclick="selectTeacher('å±±ç”°å…ˆç”Ÿ', 'advanced')">
                            <div class="piano-icon">ğŸ¶</div>
                            <div>å±±ç”°å…ˆç”Ÿ</div>
                            <div style="font-size: 0.9em; color: #8b5fb5;">ä¸Šç´š</div>
                        </div>
                    </div>
                    <div id="selectedTeacherInfo" class="selected-teacher-info" style="display: none;"></div>
                </div>

                <h3 style="margin-bottom: 15px; color: #8b5fb5;">ğŸ“… ãƒ¬ãƒƒã‚¹ãƒ³æ—¥é¸æŠ</h3>
                <div class="calendar-header">
                    <button class="calendar-nav" onclick="changeMonth(-1)">â—€</button>
                    <div class="calendar-month" id="currentMonth"></div>
                    <button class="calendar-nav" onclick="changeMonth(1)">â–¶</button>
                </div>
                <div class="calendar" id="calendar"></div>

                <div id="timeSelection" style="display: none;">
                    <h3 style="margin-bottom: 15px; color: #8b5fb5;">â° æ™‚é–“å¸¯é¸æŠ</h3>
                    <div class="time-slots" id="timeSlots"></div>
                </div>

                <div class="form-group">
                    <label for="reservationStudentId">å—è¬›è€…ç•ªå·</label>
                    <input type="text" id="reservationStudentId" maxlength="7" placeholder="1234567">
                </div>

                <div style="text-align: center;">
                    <button class="btn btn-secondary" onclick="showScreen('loginScreen')">æˆ»ã‚‹</button>
                    <button class="btn" onclick="makeReservation()">äºˆç´„</button>
                    <button class="btn btn-secondary" onclick="showScreen('confirmationScreen')">äºˆç´„ç¢ºèª</button>
                    <button class="btn btn-danger" onclick="showScreen('deleteScreen')">äºˆç´„å‰Šé™¤</button>
                </div>
            </div>
        </div>

        <!-- äºˆç´„ã‚¨ãƒ©ãƒ¼ç”»é¢ -->
        <div id="reservationErrorScreen" class="screen">
            <div class="card">
                <div class="error-message">
                    <h3 style="text-align: center;">äºˆç´„ã‚¨ãƒ©ãƒ¼</h3>
                    <div id="errorMessages"></div>
                </div>
                <div style="text-align: center;">
                    <button class="btn btn-secondary" onclick="showScreen('reservationScreen')">æˆ»ã‚‹</button>
                </div>
            </div>
        </div>

        <!-- äºˆç´„ç¢ºå®šç”»é¢ -->
        <div id="reservationConfirmScreen" class="screen">
            <div class="card">
                <div class="success-message">
                    <h3 style="text-align: center;">ğŸ‰ äºˆç´„ãŒç¢ºå®šã—ã¾ã—ãŸï¼</h3>
                    <div id="confirmationDetails" style="text-align: center; margin-top: 15px;"></div>
                </div>
                <div style="text-align: center;">
                    <button class="btn" onclick="showScreen('loginScreen')">TOPã¸æˆ»ã‚‹</button>
                </div>
            </div>
        </div>

        <!-- äºˆç´„å‰Šé™¤ç”»é¢ -->
        <div id="deleteScreen" class="screen">
            <div class="card">
                <h2 style="text-align: center; margin-bottom: 30px; color: #8b5fb5;">äºˆç´„å‰Šé™¤</h2>
                <div class="form-group">
                    <label for="deleteStudentId">å—è¬›è€…ç•ªå·</label>
                    <input type="text" id="deleteStudentId" maxlength="7" placeholder="1234567">
                </div>
                <div style="text-align: center;">
                    <button class="btn btn-secondary" onclick="showScreen('reservationScreen')">æˆ»ã‚‹</button>
                    <button class="btn btn-danger" onclick="deleteReservation()">å‰Šé™¤</button>
                </div>
            </div>
        </div>

        <!-- å‰Šé™¤ç¢ºå®šç”»é¢ -->
        <div id="deleteConfirmScreen" class="screen">
            <div class="card">
                <div class="success-message">
                    <h3 style="text-align: center;">äºˆç´„ã‚’å‰Šé™¤ã—ã¾ã—ãŸ</h3>
                </div>
                <div style="text-align: center;">
                    <button class="btn" onclick="showScreen('loginScreen')">TOPã¸æˆ»ã‚‹</button>
                </div>
            </div>
        </div>

        <!-- äºˆç´„ç¢ºèªç”»é¢ -->
        <div id="confirmationScreen" class="screen">
            <div class="card">
                <h2 style="text-align: center; margin-bottom: 30px; color: #8b5fb5;">äºˆç´„ç¢ºèª</h2>
                <div class="form-group">
                    <label for="confirmStudentId">å—è¬›è€…ç•ªå·</label>
                    <input type="text" id="confirmStudentId" maxlength="7" placeholder="1234567">
                </div>
                <div style="text-align: center;">
                    <button class="btn btn-secondary" onclick="showScreen('reservationScreen')">æˆ»ã‚‹</button>
                    <button class="btn" onclick="confirmReservation()">ç¢ºèª</button>
                </div>
            </div>
        </div>

        <!-- äºˆç´„æƒ…å ±ç”»é¢ -->
        <div id="reservationInfoScreen" class="screen">
            <div class="card">
                <h2 style="text-align: center; margin-bottom: 30px; color: #8b5fb5;">äºˆç´„æƒ…å ±</h2>
                <div id="reservationInfo" class="lesson-info"></div>
                <div style="text-align: center;">
                    <button class="btn btn-secondary" onclick="showScreen('reservationScreen')">äºˆç´„ç”»é¢ã¸</button>
                    <button class="btn" onclick="showScreen('loginScreen')">TOPã¸æˆ»ã‚‹</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let currentDate = new Date();
        let selectedDate = null;
        let selectedTime = null;
        let selectedTeacher = null;
        let reservations = {}; // äºˆç´„ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜

        // ãƒ‡ãƒ¢ç”¨ã®äºˆç´„ãƒ‡ãƒ¼ã‚¿ï¼ˆæº€æ ã®ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ ï¼‰
        const demoReservations = {
            '1234567': {
                teacher: 'ç”°ä¸­å…ˆç”Ÿ',
                date: '2025-06-25',
                time: '10:00-11:00'
            }
        };

        // æº€æ ã®æ—¥ä»˜ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ‡ãƒ¢ç”¨ï¼‰
        const fullyBookedDates = {
            '2025-06-30': true,
            '2025-07-01': true,
            '2025-07-05': true
        };

        // æ™‚é–“å¸¯åˆ¥ã®äºˆç´„çŠ¶æ³ï¼ˆãƒ‡ãƒ¢ç”¨ï¼‰
        const timeSlotBookings = {
            '2025-06-27': {
                '09:00-10:00': true,
                '10:00-11:00': false,
                '11:00-12:00': true,
                '13:00-14:00': false,
                '14:00-15:00': true,
                '15:00-16:00': false,
                '16:00-17:00': true,
                '17:00-18:00': false,
                '18:00-19:00': true
            },
            '2025-06-28': {
                '09:00-10:00': false,
                '10:00-11:00': true,
                '11:00-12:00': false,
                '13:00-14:00': true,
                '14:00-15:00': false,
                '15:00-16:00': true,
                '16:00-17:00': false,
                '17:00-18:00': true,
                '18:00-19:00': false
            }
        };

        // ç”»é¢è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        // ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†
        function login() {
            const studentId = document.getElementById('studentId').value;
            const password = document.getElementById('password').value;

            if (studentId.length === 7 && password.length > 0) {
                document.getElementById('reservationStudentId').value = studentId;
                showScreen('reservationScreen');
                initCalendar();
            } else {
                showScreen('loginErrorScreen');
            }
        }

        // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼åˆæœŸåŒ–
        function initCalendar() {
            updateCalendar();
        }

        // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼æ›´æ–°
        function updateCalendar() {
            const monthNames = [
                '1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ',
                '7æœˆ', '8æœˆ', '9æœˆ', '10æœˆ', '11æœˆ', '12æœˆ'
            ];
            
            document.getElementById('currentMonth').textContent = 
                `${currentDate.getFullYear()}å¹´ ${monthNames[currentDate.getMonth()]}`;

            const calendar = document.getElementById('calendar');
            calendar.innerHTML = '';

            // æ›œæ—¥ãƒ˜ãƒƒãƒ€ãƒ¼
            const dayNames = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
            dayNames.forEach(day => {
                const dayElement = document.createElement('div');
                dayElement.classList.add('calendar-day', 'weekday-name');
                dayElement.textContent = day;
                calendar.appendChild(dayElement);
            });

            // æœˆã®æœ€åˆã®æ—¥ã¨æœ€å¾Œã®æ—¥
            const firstDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
            const lastDay = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);

            // æœ€åˆã®é€±ã®ç©ºç™½
            for (let i = 0; i < firstDay.getDay(); i++) {
                const emptyDay = document.createElement('div');
                emptyDay.classList.add('calendar-day', 'other-month');
                calendar.appendChild(emptyDay);
            }

            // æ—¥ä»˜ã‚’è¿½åŠ 
            for (let day = 1; day <= lastDay.getDate(); day++) {
                const dayElement = document.createElement('div');
                dayElement.classList.add('calendar-day');
                dayElement.textContent = day;

                const dateStr = `${currentDate.getFullYear()}-${String(currentDate.getMonth() + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                
                // éå»ã®æ—¥ä»˜ã¯é¸æŠä¸å¯
                const today = new Date();
                const dayDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), day);
                
                if (dayDate >= today) {
                    // æº€æ ãƒã‚§ãƒƒã‚¯
                    if (fullyBookedDates[dateStr]) {
                        dayElement.classList.add('fully-booked');
                    } else {
                        dayElement.classList.add('available');
                        dayElement.onclick = () => selectDate(dateStr);
                    }
                } else {
                    dayElement.classList.add('other-month');
                }

                calendar.appendChild(dayElement);
            }
        }

        // æœˆå¤‰æ›´
        function changeMonth(direction) {
            currentDate.setMonth(currentDate.getMonth() + direction);
            updateCalendar();
        }

        // æ—¥ä»˜é¸æŠ
        function selectDate(dateStr) {
            // æº€æ ã®æ—¥ä»˜ã¯é¸æŠä¸å¯
            if (fullyBookedDates[dateStr]) {
                return;
            }

            // ä»¥å‰ã®é¸æŠã‚’ã‚¯ãƒªã‚¢
            document.querySelectorAll('.calendar-day.selected').forEach(day => {
                day.classList.remove('selected');
            });

            // æ–°ã—ã„é¸æŠã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
            event.target.classList.add('selected');
            selectedDate = dateStr;

            // æ™‚é–“å¸¯é¸æŠã‚’è¡¨ç¤º
            showTimeSlots();
        }

        // æ™‚é–“å¸¯è¡¨ç¤º
        function showTimeSlots() {
            const timeSelection = document.getElementById('timeSelection');
            const timeSlots = document.getElementById('timeSlots');
            
            timeSelection.style.display = 'block';
            timeSlots.innerHTML = '';

            const times = [
                '09:00-10:00', '10:00-11:00', '11:00-12:00',
                '13:00-14:00', '14:00-15:00', '15:00-16:00',
                '16:00-17:00', '17:00-18:00', '18:00-19:00'
            ];

            times.forEach(time => {
                const timeSlot = document.createElement('div');
                timeSlot.classList.add('time-slot');
                timeSlot.textContent = time;
                
                // é¸æŠã—ãŸæ—¥ä»˜ã®äºˆç´„çŠ¶æ³ã‚’ãƒã‚§ãƒƒã‚¯
                const dayBookings = timeSlotBookings[selectedDate];
                if (dayBookings && dayBookings[time]) {
                    // äºˆç´„æ¸ˆã¿ã®æ™‚é–“å¸¯
                    timeSlot.classList.add('booked');
                    timeSlot.style.cursor = 'not-allowed';
                } else {
                    // äºˆç´„å¯èƒ½ãªæ™‚é–“å¸¯
                    timeSlot.onclick = () => selectTime(time);
                }
                
                timeSlots.appendChild(timeSlot);
            });
        }

        // æ™‚é–“é¸æŠ
        function selectTime(time) {
            // äºˆç´„æ¸ˆã¿ã®æ™‚é–“å¸¯ã¯é¸æŠä¸å¯
            const dayBookings = timeSlotBookings[selectedDate];
            if (dayBookings && dayBookings[time]) {
                return;
            }

            document.querySelectorAll('.time-slot.selected').forEach(slot => {
                slot.classList.remove('selected');
            });

            event.target.classList.add('selected');
            selectedTime = time;
        }

        // å…ˆç”Ÿé¸æŠ
        function selectTeacher(teacher, level) {
            document.querySelectorAll('.teacher-card.selected').forEach(card => {
                card.classList.remove('selected', 'beginner', 'intermediate', 'advanced');
            });

            event.target.classList.add('selected', level);
            selectedTeacher = teacher;

            // é¸æŠã—ãŸå…ˆç”Ÿã®æƒ…å ±ã‚’è¡¨ç¤º
            const selectedInfo = document.getElementById('selectedTeacherInfo');
            const levelText = level === 'beginner' ? 'åˆç´š' : level === 'intermediate' ? 'ä¸­ç´š' : 'ä¸Šç´š';
            selectedInfo.innerHTML = `é¸æŠä¸­ï¼š${teacher} ï¼ˆ${levelText}ï¼‰`;
            selectedInfo.style.display = 'block';
        }

        // äºˆç´„å‡¦ç†
        function makeReservation() {
            const studentId = document.getElementById('reservationStudentId').value;
            const errors = [];

            if (!selectedDate) errors.push('ãƒ¬ãƒƒã‚¹ãƒ³æ—¥ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚');
            if (!selectedTime) errors.push('æ™‚é–“å¸¯ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚');
            if (!studentId || studentId.length !== 7) errors.push('å—è¬›è€…ç•ªå·ãŒæ­£ã—ãå…¥åŠ›ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚');
            if (!selectedTeacher) errors.push('è¬›å¸«ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚');

            if (errors.length > 0) {
                document.getElementById('errorMessages').innerHTML = errors.map(error => `<p>â€¢ ${error}</p>`).join('');
                showScreen('reservationErrorScreen');
                return;
            }

            // äºˆç´„å®Œäº†
            reservations[studentId] = {
                teacher: selectedTeacher,
                date: selectedDate,
                time: selectedTime
            };

            document.getElementById('confirmationDetails').innerHTML = `
                <p><strong>å—è¬›è€…ç•ªå·:</strong> ${studentId}</p>
                <p><strong>è¬›å¸«:</strong> ${selectedTeacher}</p>
                <p><strong>äºˆç´„æ—¥æ™‚:</strong> ${selectedDate} ${selectedTime}</p>
            `;

            showScreen('reservationConfirmScreen');
        }

        // äºˆç´„å‰Šé™¤
        function deleteReservation() {
            const studentId = document.getElementById('deleteStudentId').value;
            
            if (reservations[studentId] || demoReservations[studentId]) {
                delete reservations[studentId];
                showScreen('deleteConfirmScreen');
            } else {
                alert('è©²å½“ã™ã‚‹äºˆç´„ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚');
            }
        }

        // äºˆç´„ç¢ºèª
        function confirmReservation() {
            const studentId = document.getElementById('confirmStudentId').value;
            const reservation = reservations[studentId] || demoReservations[studentId];
            
            if (reservation) {
                document.getElementById('reservationInfo').innerHTML = `
                    <p><strong>å—è¬›è€…ç•ªå·:</strong> ${studentId}</p>
                    <p><strong>è¬›å¸«:</strong> ${reservation.teacher}</p>
                    <p><strong>äºˆç´„æ—¥æ™‚:</strong> ${reservation.date} ${reservation.time}</p>
                showScreen('reservationInfoScreen');
            } else {
                alert('è©²å½“ã™ã‚‹äºˆç´„ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚');
            }
        }

        // ã‚¨ãƒ³ã‚¿ãƒ¼ã‚­ãƒ¼ã§ãƒ­ã‚°ã‚¤ãƒ³
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('studentId').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    login();
                }
            });
            
            document.getElementById('password').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    login();
                }
            });
        });
    </script>
</body>
</html> 